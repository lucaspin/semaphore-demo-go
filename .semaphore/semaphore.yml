version: v1.0
name: Semaphore Go CI example
agent:
  machine:
    type: f1-standard-2
    os_image: ubuntu2204
blocks:
  - name: Build project
    task:
      jobs:
        - name: Test
          commands:
            - mkdir -p .workflow_editor/.semaphore
            - echo "main pipeline" > .workflow_editor/.semaphore/semaphore.yml
            - echo "integration" > .workflow_editor/.semaphore/integration.yml
            - mkdir -p .workflow_editor/.semaphore/release
            - echo "prod" > .workflow_editor/.semaphore/release/prod.yml
            - echo "preprod" > .workflow_editor/.semaphore/release/preprod.yml
            - mkdir -p .workflow_editor/.semaphore/release/other
            - echo "a" > .workflow_editor/.semaphore/release/other/a.yml
            - echo "b" > .workflow_editor/.semaphore/release/other/b.yml
            - echo "c" > .workflow_editor/.semaphore/release/other/c.yml
            - artifact push job .workflow_editor/.semaphore -d .workflow_editor/.semaphore
