version: v1.0
name: 'Deploy - A=${{parameters.VERSION}}'
agent:
  machine:
    type: f1-standard-2
    os_image: ubuntu2004
blocks:
  - name: Build
    task:
      jobs:
        - name: 'Job #1'
          commands:
            - IMAGE=$(uuidgen)
            - echo $IMAGE
            - |
              curl -X POST \
                -H "Content-Type: application/json" \
                -H "Authorization: Bearer $SEMAPHORE_STAGE_EXECUTION_TOKEN" \
                --data "{\"execution_id\":\"$SEMAPHORE_STAGE_EXECUTION_ID\",\"outputs\":{\"IMAGE\":\"$IMAGE\"}}" \
                https://superplane.sxmoon.com/api/v1/outputs
            - echo Done
